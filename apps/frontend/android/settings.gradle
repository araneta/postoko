pluginManagement {
  // âœ… kotlinVersion MUST be defined here for RN Gradle plugin
  ext.kotlinVersion = "1.9.24"

  repositories {
    gradlePluginPortal()
    google()
    mavenCentral()
  }

  resolutionStrategy {
    eachPlugin {
      if (requested.id.id == "com.facebook.react.settings" ||
          requested.id.id == "com.facebook.react") {
        useModule("com.facebook.react:react-native-gradle-plugin")
      }
    }
  }

  includeBuild(
    new File(
      ["node", "--print", "require.resolve('@react-native/gradle-plugin/package.json', { paths: [require.resolve('react-native/package.json')] })"]
        .execute(null, rootDir)
        .text
        .trim()
    ).getParentFile()
  )

  includeBuild("../node_modules/expo-modules-core/android")
}

plugins {
  id("com.facebook.react.settings")
}

dependencyResolutionManagement {
  repositoriesMode.set(RepositoriesMode.PREFER_SETTINGS)
  repositories {
    google()
    mavenCentral()
  }
}

rootProject.name = "bolt-expo-pos"

extensions.configure(com.facebook.react.ReactSettingsExtension) { ex ->
  if (System.getenv("EXPO_USE_COMMUNITY_AUTOLINKING") == "1") {
    ex.autolinkLibrariesFromCommand()
  } else {
    def command = [
      "node",
      "--no-warnings",
      "--eval",
      "require(require.resolve('expo-modules-autolinking', { paths: [require.resolve('expo/package.json')] }))(process.argv.slice(1))",
      "react-native-config",
      "--json",
      "--platform",
      "android"
    ]
    ex.autolinkLibrariesFromCommand(command)
  }
}

apply from: new File(
  ["node", "--print", "require.resolve('expo/package.json')"]
    .execute(null, rootDir)
    .text
    .trim(),
  "../scripts/autolinking.gradle"
)

useExpoModules()

include(":app")
